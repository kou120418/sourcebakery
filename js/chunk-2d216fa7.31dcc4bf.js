(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d216fa7"],{c587:function(e,t,c){"use strict";c.r(t);c("a4d3"),c("e01a");var l=c("7a23"),a={class:"container content"},o=Object(l["createElementVNode"])("h2",{class:"text-center"},"文章列表",-1),n={class:"text-end mt-4"},r={class:"row justify-content-center mt-3"},i={class:"card h-100"},d={class:"card-header min-vh-75 d-flex align-items-center"},s={class:"article-img-block"},m=["src"],b={class:"card-body d-flex flex-column justify-content-end"},u={class:"badge bg-primary mb-1"},p={class:"card-title mt-1 fs-6"},j={key:0},O=Object(l["createElementVNode"])("i",{class:"bi bi-check-circle-fill"},null,-1),h=[O],f={class:"card-subtitle"},g={class:"card-text text-muted"},V={class:"btn-group w-100 mt-3"},E=Object(l["createTextVNode"])("編輯"),N=["onClick"],v={class:"d-flex justify-content-center mt-5 mb-4"};function A(e,t,c,O,A,w){var y=Object(l["resolveComponent"])("Loading"),k=Object(l["resolveComponent"])("router-link"),x=Object(l["resolveComponent"])("Pagination"),_=Object(l["resolveComponent"])("AdminArticleModal"),M=Object(l["resolveComponent"])("DelArticleModal");return Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[Object(l["createVNode"])(y,{active:A.isLoading,"z-index":1500},null,8,["active"]),Object(l["createElementVNode"])("div",a,[o,Object(l["createElementVNode"])("div",n,[Object(l["createElementVNode"])("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=function(e){return w.openModal("new")})}," 新增文章 ")]),Object(l["createElementVNode"])("div",r,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(A.articles,(function(t){return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:t,class:"col-10 col-md-6 col-lg-5 col-xl-4 mb-4"},[Object(l["createElementVNode"])("div",i,[Object(l["createElementVNode"])("h5",d,Object(l["toDisplayString"])(t.title),1),Object(l["createElementVNode"])("div",s,[Object(l["createElementVNode"])("img",{src:t.image,alt:"",class:"article-img"},null,8,m)]),Object(l["createElementVNode"])("div",b,[Object(l["createElementVNode"])("span",u,Object(l["toDisplayString"])(t.tag),1),Object(l["createElementVNode"])("h5",p,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(t.description),1),t.isPublic?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",j,h)):Object(l["createCommentVNode"])("",!0)]),Object(l["createElementVNode"])("p",f,"作者："+Object(l["toDisplayString"])(t.author),1),Object(l["createElementVNode"])("small",g," 貼文日期："+Object(l["toDisplayString"])(e.$filters.date(t.create_at)),1),Object(l["createElementVNode"])("div",V,[Object(l["createVNode"])(k,{class:"btn btn-outline-primary btn-sm",to:"/admin/article/".concat(t.id)},{default:Object(l["withCtx"])((function(){return[E]})),_:2},1032,["to"]),Object(l["createElementVNode"])("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:function(e){return w.openModal("delete",t)}}," 刪除 ",8,N)])])])])})),128))]),Object(l["createElementVNode"])("div",v,[Object(l["createVNode"])(x,{page:A.pagination,onGetPage:w.getArticles},null,8,["page","onGetPage"])]),Object(l["createVNode"])(_,{ref:"adminModal","props-article":A.tempArticle,onUpdateArticle:w.updateArticle},null,8,["props-article","onUpdateArticle"]),Object(l["createVNode"])(M,{ref:"adminDelModal","props-article":A.tempArticle,onDeleteArticle:w.deleteArticle},null,8,["props-article","onDeleteArticle"])])],64)}var w=c("5530"),y=(c("99af"),c("1671")),k={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"articleModalLabel","aria-hidden":"true"},x={class:"modal-dialog modal-xl modal-dialog-centered"},_={class:"modal-content border-0"},M=Object(l["createElementVNode"])("div",{class:"modal-header bg-primary text-white"},[Object(l["createElementVNode"])("h3",{id:"articleModalLabel",class:"modal-title"},[Object(l["createElementVNode"])("span",null,"新增文章")]),Object(l["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D={class:"modal-body"},C={class:"row mt-3"},P={class:"form-group col-md-4"},U=Object(l["createElementVNode"])("label",{for:"author"},"作者名稱",-1),L={class:"form-group col-md-4"},$=Object(l["createElementVNode"])("label",{for:"tag"},"分類標籤",-1),B={class:"form-group col-md-4"},T=Object(l["createElementVNode"])("label",{for:"create_at"},"建立時間",-1),S=Object(l["createElementVNode"])("hr",null,null,-1),I={class:"row mt-3"},F={class:"form-group col-md-3"},G=Object(l["createElementVNode"])("label",{for:"title"},"文章標題",-1),J={class:"form-group col-9"},R=Object(l["createElementVNode"])("label",{for:"description"},"文章簡述",-1),z={class:"row mt-3"},H={class:"form-group col-md-4"},Q={class:"form-group"},q=Object(l["createElementVNode"])("label",{class:"text-light bg-secondary mb-2 py-1 px-2",for:"mainImageUrl"},"請輸入文章圖片網址",-1),K=["src","alt"],W={class:"btn btn-outline-success btn-sm d-block w-100 mt-3"},X=Object(l["createTextVNode"])(" 上傳圖片 "),Y={class:"form-group col-md-8"},Z=Object(l["createElementVNode"])("label",{for:"content"},"文章內容",-1),ee={class:"form-group mt-3"},te={class:"form-check"},ce=Object(l["createElementVNode"])("label",{class:"form-check-label",for:"isPublic"},"是否啟用",-1),le={class:"modal-footer"},ae=Object(l["createElementVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function oe(e,t,c,a,o,n){var r=Object(l["resolveComponent"])("ckeditor");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",k,[Object(l["createElementVNode"])("div",x,[Object(l["createElementVNode"])("div",_,[M,Object(l["createElementVNode"])("div",D,[Object(l["createElementVNode"])("div",C,[Object(l["createElementVNode"])("div",P,[U,Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{id:"author",type:"text",class:"form-control mt-1",placeholder:"請輸入作者名稱","onUpdate:modelValue":t[0]||(t[0]=function(e){return o.newArticle.author=e})},null,512),[[l["vModelText"],o.newArticle.author]])]),Object(l["createElementVNode"])("div",L,[$,Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{id:"tag",type:"text",class:"form-control mt-1",placeholder:"請輸入分類標籤","onUpdate:modelValue":t[1]||(t[1]=function(e){return o.newArticle.tag=e})},null,512),[[l["vModelText"],o.newArticle.tag]])]),Object(l["createElementVNode"])("div",B,[T,Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{id:"create_at",type:"date",class:"form-control mt-1",placeholder:"請輸入建立時間","onUpdate:modelValue":t[2]||(t[2]=function(e){return o.create_at=e})},null,512),[[l["vModelText"],o.create_at]])])]),S,Object(l["createElementVNode"])("div",I,[Object(l["createElementVNode"])("div",F,[G,Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{id:"title",type:"text",class:"form-control mt-1",placeholder:"請輸入文章標題","onUpdate:modelValue":t[3]||(t[3]=function(e){return o.newArticle.title=e})},null,512),[[l["vModelText"],o.newArticle.title]])]),Object(l["createElementVNode"])("div",J,[R,Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{id:"description",type:"text",class:"form-control mt-1",placeholder:"請輸入文章簡述","onUpdate:modelValue":t[4]||(t[4]=function(e){return o.newArticle.description=e})},null,512),[[l["vModelText"],o.newArticle.description,void 0,{trim:!0}]])])]),Object(l["createElementVNode"])("div",z,[Object(l["createElementVNode"])("div",H,[Object(l["createElementVNode"])("div",Q,[q,Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{id:"mainImageUrl",type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":t[5]||(t[5]=function(e){return o.newArticle.image=e})},null,512),[[l["vModelText"],o.newArticle.image,void 0,{trim:!0}]]),Object(l["createElementVNode"])("img",{class:"img-fluid my-3 form-img",src:o.newArticle.image,alt:o.newArticle.title},null,8,K)]),Object(l["createElementVNode"])("label",W,[Object(l["createElementVNode"])("input",{id:"upload_img",style:{display:"none"},type:"file",onChange:t[6]||(t[6]=function(){return n.uploadMainImgage&&n.uploadMainImgage.apply(n,arguments)})},null,32),X])]),Object(l["createElementVNode"])("div",Y,[Z,Object(l["createVNode"])(r,{class:"form-control mt-1",placeholder:"請輸入文章內容",editor:o.editor,config:o.editorConfig,rows:"12",modelValue:o.newArticle.content,"onUpdate:modelValue":t[7]||(t[7]=function(e){return o.newArticle.content=e})},null,8,["editor","config","modelValue"])])]),Object(l["createElementVNode"])("div",ee,[Object(l["createElementVNode"])("div",te,[Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{id:"isPublic",class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,"onUpdate:modelValue":t[8]||(t[8]=function(e){return o.newArticle.isPublic=e})},null,512),[[l["vModelCheckbox"],o.newArticle.isPublic]]),ce])])]),Object(l["createElementVNode"])("div",le,[ae,Object(l["createElementVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[9]||(t[9]=function(t){return e.$emit("update-article",c.propsArticle)})}," 確認 ")])])])],512)}var ne=c("3835"),re=(c("ac1f"),c("1276"),c("fb3d")),ie=c.n(re),de=c("a8d2"),se={emits:["update-article"],props:{propsArticle:{type:Object,default:function(){return{}}}},data:function(){return{modal:"",create_at:"",editor:ie.a,editorConfig:{toolbar:{items:["heading","|","bold","italic","|","bulletedList","numberedList","|","blockQuote","insertTable","link","|","mediaEmbed"]}},newArticle:[]}},methods:{showErrorAlert:function(e){this.$swal({title:e,icon:"error"})},uploadMainImgage:function(e){var t=this;console.dir(e);var c="".concat(Object({NODE_ENV:"production",VUE_APP_PATH:"kouyu_api_practice",VUE_APP_URL:"https://vue3-course-api.hexschool.io",BASE_URL:"/sourcebakery/"}).VUE_APP_API,"api/").concat("kouyu_api_practice","/admin/upload"),l=e.target.files[0],a=new FormData;a.append("file-to-upload",l),this.$http.post(c,a).then((function(e){t.newArticle.image=e.data.imageUrl})).catch((function(e){t.showErrorAlert(e)}))}},watch:{propsArticle:function(){this.newArticle=this.propsArticle;var e=new Date(1e3*this.newArticle.create_at).toISOString().split("T"),t=Object(ne["a"])(e,1);this.create_at=t[0]},create_at:function(){this.newArticle.create_at=Math.floor(new Date(this.create_at)/1e3)}},mixins:[de["a"]]},me=c("6b0d"),be=c.n(me),ue=be()(se,[["render",oe]]),pe={id:"delArticleModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delArticleModalLabel","aria-hidden":"true"},je={class:"modal-dialog modal-dialog-centered"},Oe={class:"modal-content border-0"},he=Object(l["createElementVNode"])("div",{class:"modal-header bg-danger text-white"},[Object(l["createElementVNode"])("h3",{id:"delArticleModalLabel",class:"modal-title"},[Object(l["createElementVNode"])("span",null,"刪除文章")]),Object(l["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),fe={class:"modal-body"},ge=Object(l["createTextVNode"])(" 是否刪除文章"),Ve=Object(l["createElementVNode"])("br",null,null,-1),Ee={class:"text-danger"},Ne={class:"modal-footer"},ve=Object(l["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ae(e,t,c,a,o,n){return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",pe,[Object(l["createElementVNode"])("div",je,[Object(l["createElementVNode"])("div",Oe,[he,Object(l["createElementVNode"])("div",fe,[ge,Ve,Object(l["createElementVNode"])("strong",Ee,Object(l["toDisplayString"])(c.propsArticle.title),1)]),Object(l["createElementVNode"])("div",Ne,[ve,Object(l["createElementVNode"])("button",{onClick:t[0]||(t[0]=function(t){return e.$emit("delete-article",c.propsArticle)}),type:"button",class:"btn btn-danger"}," 確認刪除 ")])])])],512)}var we={emits:["delete-article"],props:{propsArticle:{type:Object,default:function(){return{}}}},data:function(){return{modal:""}},mixins:[de["a"]]},ye=be()(we,[["render",Ae]]),ke={data:function(){return{isLoading:!1,isNew:!0,articles:{},pagination:{},tempArticle:{}}},components:{Pagination:y["a"],AdminArticleModal:ue,DelArticleModal:ye},methods:{showAlert:function(e){this.$swal(e.data.message)},showErrorAlert:function(e){this.$swal({title:e,icon:"error"})},getArticles:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination.current_page||1,c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("kouyu_api_practice","/admin/articles?page=").concat(t);this.$http.get(c).then((function(t){if(t.data.success){var c=t.data,l=c.articles,a=c.pagination;e.articles=l,e.pagination=a,e.isLoading=!1}})).catch((function(t){e.showErrorAlert(t)}))},deleteArticle:function(){var e=this,t="".concat("https://vue3-course-api.hexschool.io","/api/").concat("kouyu_api_practice","/admin/article/").concat(this.tempArticle.id);this.$http.delete(t).then((function(t){e.$refs.adminDelModal.hideModal(),e.showAlert(t),e.getArticles()})).catch((function(t){e.showErrorAlert(t)}))},updateArticle:function(e){var t=this;console.log(e);var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("kouyu_api_practice","/admin/article/"),l="post";this.isNew||(c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("kouyu_api_practice","/admin/article/").concat(e.id),l="put"),this.$http[l](c,{data:e}).then((function(e){e.data.success&&(console.log(e),t.$refs.adminModal.hideModal(),t.showAlert(e),t.getArticles())})).catch((function(e){t.showErrorAlert(e)}))},openModal:function(e,t){switch(e){case"new":this.tempArticle={create_at:Math.floor(Date.now()/1e3),image:[],tag:[],isPublic:!1},this.isNew=!0,this.$refs.adminModal.openModal();break;case"delete":this.tempArticle=Object(w["a"])({},t),this.$refs.adminDelModal.openModal();break;default:break}}},mounted:function(){this.isLoading=!0,this.getArticles()}};t["default"]=be()(ke,[["render",A]])}}]);
//# sourceMappingURL=chunk-2d216fa7.31dcc4bf.js.map