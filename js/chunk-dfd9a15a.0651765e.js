(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dfd9a15a"],{"860c":function(e,t,l){"use strict";l.r(t);l("b0c0");var c=l("7a23"),a={class:"container content"},r=Object(c["createElementVNode"])("h2",{class:"text-center"},"訂單列表",-1),n={class:"d-flex justify-content-center mt-5"},o={class:"table align-middle mt-4"},d=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",{width:"8%"},"訂單日期"),Object(c["createElementVNode"])("th",{width:"9%"},"客戶姓名"),Object(c["createElementVNode"])("th",{width:"10%"},"客戶信箱"),Object(c["createElementVNode"])("th",{width:"10%"},"客戶電話"),Object(c["createElementVNode"])("th",{width:"18%"},"客戶地址"),Object(c["createElementVNode"])("th",{width:"11%"},"訂單總價"),Object(c["createElementVNode"])("th",{class:"text-end",width:"9%"},"付款狀態"),Object(c["createElementVNode"])("th",{width:"12%"})])],-1),s={class:"h5"},i={class:"text-end"},b={key:0,class:"text-success"},m={key:1,class:"text-muted"},O={class:"text-end"},u={class:"btn-group"},p=["onClick"],j=["onClick"],E={key:0,class:"material-icons animate-spin"},h=Object(c["createTextVNode"])(" 刪除 "),N={colspan:"8",class:"text-end"},V=["disabled"],g={key:0,class:"material-icons animate-spin"},f=Object(c["createTextVNode"])(" 刪除所有訂單 "),y={class:"d-flex justify-content-center mt-5"};function k(e,t,l,k,v,x){var B=Object(c["resolveComponent"])("Pagination"),D=Object(c["resolveComponent"])("AdminOrderModal"),w=Object(c["resolveComponent"])("DelOrdersModal"),M=Object(c["resolveComponent"])("DelAllOrders");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",a,[r,Object(c["createElementVNode"])("div",n,[Object(c["createVNode"])(B,{page:v.pagination,onGetPage:x.getOrders},null,8,["page","onGetPage"])]),Object(c["createElementVNode"])("table",o,[d,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(v.orders,(function(t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{class:"align-middle",key:t.id},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.$filters.date(t.create_at)),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.user.name),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.user.email),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.user.tel),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.user.address),1),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("div",s,"NT$"+Object(c["toDisplayString"])(e.$filters.currency(t.total))+" 元",1)]),Object(c["createElementVNode"])("td",i,[t.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("strong",b,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",m,"未付款"))]),Object(c["createElementVNode"])("td",O,[Object(c["createElementVNode"])("div",u,[Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:function(e){return x.openModal("edit",t)}}," 查看 ",8,p),Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:function(e){return x.openModal("delete",t)}},[v.loadingStatus.loadingItem===t.id?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",E," cached ")):Object(c["createCommentVNode"])("",!0),h],8,j)])])])})),128))]),Object(c["createElementVNode"])("tfoot",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("td",N,[Object(c["createElementVNode"])("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=function(t){return x.openModal("deleteAll",e.item)}),disabled:v.orders<=1},[1===v.loadingStatus.loadingItem?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",g," cached ")):Object(c["createCommentVNode"])("",!0),f],8,V)])])])]),Object(c["createElementVNode"])("div",y,[Object(c["createVNode"])(B,{page:v.pagination,onGetPage:x.getOrders},null,8,["page","onGetPage"])]),Object(c["createVNode"])(D,{ref:"adminModal","props-order":v.tempOrder,onUpdateOrder:x.updateOrder},null,8,["props-order","onUpdateOrder"]),Object(c["createVNode"])(w,{ref:"adminDelModal","props-order":v.tempOrder,onDeleteOrders:x.deleteOrder},null,8,["props-order","onDeleteOrders"]),Object(c["createVNode"])(M,{ref:"adminAllOrderDelModal",onDeleteAllOrders:x.deleteAllOrders},null,8,["onDeleteAllOrders"])])}var v=l("5530"),x=(l("99af"),l("1671")),B={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"customerOrderModalLabel","aria-hidden":"true"},D={class:"modal-dialog modal-xl modal-dialog-centered"},w={class:"modal-content border-0"},M=Object(c["createElementVNode"])("div",{class:"modal-header bg-primary text-white"},[Object(c["createElementVNode"])("h3",{id:"customerOrderModalLabel",class:"modal-title"},[Object(c["createElementVNode"])("span",null,"修改客戶訂單內容")]),Object(c["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),S={class:"modal-body"},A=Object(c["createElementVNode"])("h3",{class:"text-primary"},"選購商品",-1),C={class:"px-3"},$={class:"table align-middle"},_=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"縮圖"),Object(c["createElementVNode"])("th",null,"品名"),Object(c["createElementVNode"])("th",null,"類別"),Object(c["createElementVNode"])("th",null,"數量"),Object(c["createElementVNode"])("th",{class:"text-end"},"單價"),Object(c["createElementVNode"])("th",{class:"text-end"},"合計")])],-1),I=["src","alt"],L={class:"text-end"},T={class:"text-end"},P={class:"row"},G={class:"col-md-4"},U=Object(c["createElementVNode"])("h3",{class:"text-primary"},"用戶資料",-1),F={class:"table"},q={key:0},J=Object(c["createElementVNode"])("th",{style:{width:"100px"}},"姓名",-1),X=Object(c["createElementVNode"])("th",null,"Email",-1),z=Object(c["createElementVNode"])("th",null,"電話",-1),H=Object(c["createElementVNode"])("th",null,"地址",-1),K={class:"col-md-8"},Q=Object(c["createElementVNode"])("h3",{class:"text-primary"},"訂單細節",-1),R={class:"table"},W=Object(c["createElementVNode"])("th",{style:{width:"100px"}},"訂單編號",-1),Y=Object(c["createElementVNode"])("th",null,"下單時間",-1),Z=Object(c["createElementVNode"])("th",null,"付款時間",-1),ee={key:0},te={key:1},le=Object(c["createElementVNode"])("th",null,"付款狀態",-1),ce={key:0,class:"text-success"},ae={key:1,class:"text-muted"},re=Object(c["createElementVNode"])("th",null,"總金額",-1),ne={class:"d-flex justify-content-end"},oe={class:"form-check"},de={class:"form-check-label",for:"flexCheckDefault"},se={key:0},ie={key:1},be={class:"modal-footer"},me=Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Oe(e,t,l,a,r,n){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",B,[Object(c["createElementVNode"])("div",D,[Object(c["createElementVNode"])("div",w,[M,Object(c["createElementVNode"])("div",S,[A,Object(c["createElementVNode"])("div",C,[Object(c["createElementVNode"])("table",$,[_,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(r.tempOrder.products,(function(t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:t.id},[Object(c["createElementVNode"])("th",null,[Object(c["createElementVNode"])("img",{class:"product-img",src:t.product.imageUrl,alt:t.product.title},null,8,I)]),Object(c["createElementVNode"])("th",null,Object(c["toDisplayString"])(t.product.title),1),Object(c["createElementVNode"])("th",null,Object(c["toDisplayString"])(t.product.category),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.qty)+" / "+Object(c["toDisplayString"])(t.product.unit),1),Object(c["createElementVNode"])("td",L,Object(c["toDisplayString"])(e.$filters.currency(t.product.price)),1),Object(c["createElementVNode"])("td",T,Object(c["toDisplayString"])(e.$filters.currency(t.qty*t.product.price)),1)])})),128))])])]),Object(c["createElementVNode"])("div",P,[Object(c["createElementVNode"])("div",G,[U,Object(c["createElementVNode"])("table",F,[r.tempOrder.user?(Object(c["openBlock"])(),Object(c["createElementBlock"])("tbody",q,[Object(c["createElementVNode"])("tr",null,[J,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(r.tempOrder.user.name),1)]),Object(c["createElementVNode"])("tr",null,[X,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(r.tempOrder.user.email),1)]),Object(c["createElementVNode"])("tr",null,[z,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(r.tempOrder.user.tel),1)]),Object(c["createElementVNode"])("tr",null,[H,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(r.tempOrder.user.address),1)])])):Object(c["createCommentVNode"])("",!0)])]),Object(c["createElementVNode"])("div",K,[Q,Object(c["createElementVNode"])("table",R,[Object(c["createElementVNode"])("tbody",null,[Object(c["createElementVNode"])("tr",null,[W,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(r.tempOrder.id),1)]),Object(c["createElementVNode"])("tr",null,[Y,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.$filters.date(r.tempOrder.create_at)),1)]),Object(c["createElementVNode"])("tr",null,[Z,Object(c["createElementVNode"])("td",null,[r.tempOrder.paid_date?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",ee,Object(c["toDisplayString"])(e.$filters.date(r.tempOrder.paid_date)),1)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",te,"尚無資訊"))])]),Object(c["createElementVNode"])("tr",null,[le,Object(c["createElementVNode"])("td",null,[r.tempOrder.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("strong",ce,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",ae,"尚未付款"))])]),Object(c["createElementVNode"])("tr",null,[re,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.$filters.currency(r.tempOrder.total)),1)])])])]),Object(c["createElementVNode"])("div",ne,[Object(c["createElementVNode"])("div",oe,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":t[0]||(t[0]=function(e){return r.tempOrder.is_paid=e}),onClick:t[1]||(t[1]=function(e){return n.paidTime()})},null,512),[[c["vModelCheckbox"],r.tempOrder.is_paid]]),Object(c["createElementVNode"])("label",de,[r.tempOrder.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",se,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",ie,"未付款"))])])])])]),Object(c["createElementVNode"])("div",be,[me,Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[2]||(t[2]=function(t){return e.$emit("update-order",r.tempOrder)})}," 確認 ")])])])],512)}var ue=l("a8d2"),pe={emits:["update-order"],props:{propsOrder:{type:Object,default:function(){return{}}}},data:function(){return{modal:"",tempOrder:{}}},methods:{paidTime:function(){this.tempOrder.paid_date?this.tempOrder.paid_date="":this.tempOrder.paid_date=Math.floor(Date.now()/1e3)}},watch:{propsOrder:function(){this.tempOrder=this.propsOrder}},mixins:[ue["a"]]},je=l("6b0d"),Ee=l.n(je),he=Ee()(pe,[["render",Oe]]),Ne={id:"delOrderModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},Ve={class:"modal-dialog modal-dialog-centered"},ge={class:"modal-content border-0"},fe=Object(c["createElementVNode"])("div",{class:"modal-header bg-danger text-white"},[Object(c["createElementVNode"])("h3",{id:"delOrderModalLabel",class:"modal-title"},[Object(c["createElementVNode"])("span",null,"刪除單筆訂單")]),Object(c["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ye={key:0,class:"modal-body"},ke=Object(c["createTextVNode"])(" 是否刪除 "),ve={class:"text-danger"},xe=Object(c["createTextVNode"])(" 的訂單(刪除後將無法恢復)。 "),Be={class:"modal-footer"},De=Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function we(e,t,l,a,r,n){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",Ne,[Object(c["createElementVNode"])("div",Ve,[Object(c["createElementVNode"])("div",ge,[fe,l.propsOrder.id?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",ye,[ke,Object(c["createElementVNode"])("strong",ve,Object(c["toDisplayString"])(l.propsOrder.user.name),1),xe])):Object(c["createCommentVNode"])("",!0),Object(c["createElementVNode"])("div",Be,[De,Object(c["createElementVNode"])("button",{onClick:t[0]||(t[0]=function(t){return e.$emit("delete-orders",l.propsOrder)}),type:"button",class:"btn btn-danger"}," 確認刪除 ")])])])],512)}var Me={emits:["delete-orders"],props:{propsOrder:{type:Object,default:function(){return{}}}},data:function(){return{modal:""}},mixins:[ue["a"]]},Se=Ee()(Me,[["render",we]]),Ae={id:"delAllOrderModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delAllOrderModalLabel","aria-hidden":"true"},Ce={class:"modal-dialog modal-dialog-centered"},$e={class:"modal-content border-0"},_e=Object(c["createStaticVNode"])('<div class="modal-header bg-danger text-white"><h3 id="delAllOrderModalLabel" class="modal-title"><span>刪除全部訂單</span></h3><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body text-center"> 是否刪除所有訂單<br><strong class="text-danger fs-4">刪除後將無法復原</strong></div>',2),Ie={class:"modal-footer"},Le=Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Te(e,t,l,a,r,n){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",Ae,[Object(c["createElementVNode"])("div",Ce,[Object(c["createElementVNode"])("div",$e,[_e,Object(c["createElementVNode"])("div",Ie,[Le,Object(c["createElementVNode"])("button",{onClick:t[0]||(t[0]=function(t){return e.$emit("delete-all-orders")}),type:"button",class:"btn btn-danger"}," 確認刪除 ")])])])],512)}var Pe={emits:["delete-all-orders"],data:function(){return{modal:""}},mixins:[ue["a"]]},Ge=Ee()(Pe,[["render",Te]]),Ue={data:function(){return{orders:{},loadingStatus:{loadingItem:""},pagination:{},tempOrder:{}}},components:{Pagination:x["a"],AdminOrderModal:he,DelOrdersModal:Se,DelAllOrders:Ge},methods:{showAlert:function(e){this.$swal(e.data.message)},showErrorAlert:function(e){this.$swal({title:e,icon:"error"})},getOrders:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination.current_page||1,l="".concat("https://vue3-course-api.hexschool.io","/api/").concat("kouyu_api_practice","/orders?page=").concat(t);this.$http.get(l).then((function(t){if(t.data.success){var l=t.data,c=l.orders,a=l.pagination;e.orders=c,e.pagination=a}})).catch((function(t){e.showErrorAlert(t)}))},deleteOrder:function(e){var t=this;this.loadingStatus.loadingItem=e.id;var l="".concat("https://vue3-course-api.hexschool.io","/api/").concat("kouyu_api_practice","/admin/order/").concat(e.id);this.$http.delete(l).then((function(e){e.data.success&&(t.loadingStatus.loadingItem="",t.$refs.adminDelModal.hideModal(),t.showAlert(e),t.getOrders())})).catch((function(e){t.showErrorAlert(e)}))},deleteAllOrders:function(){var e=this;this.loadingStatus.loadingItem=1;var t="".concat("https://vue3-course-api.hexschool.io","/api/").concat("kouyu_api_practice","/admin/orders/all");this.$http.delete(t).then((function(t){t.data.success&&(e.loadingStatus.loadingItem="",e.$refs.adminAllOrderDelModal.hideModal(),e.showAlert(t),e.getOrders())})).catch((function(t){e.showErrorAlert(t)}))},openModal:function(e,t){switch(e){case"edit":this.getOrders(),this.tempOrder=Object(v["a"])({},t),this.$refs.adminModal.openModal();break;case"delete":this.tempOrder=Object(v["a"])({},t),this.$refs.adminDelModal.openModal();break;case"deleteAll":this.$refs.adminAllOrderDelModal.openModal();break;default:break}},updateOrder:function(e){var t=this,l="".concat("https://vue3-course-api.hexschool.io","/api/").concat("kouyu_api_practice","/admin/order/").concat(e.id);this.$http.put(l,{data:e}).then((function(e){e.data.success?(t.$refs.adminModal.hideModal(),t.getOrders()):t.showAlert(e)})).catch((function(e){t.showErrorAlert(e)}))}},mounted:function(){this.getOrders()}};t["default"]=Ee()(Ue,[["render",k]])},b0c0:function(e,t,l){var c=l("83ab"),a=l("5e77").EXISTS,r=l("9bf2").f,n=Function.prototype,o=n.toString,d=/^\s*function ([^ (]*)/,s="name";c&&!a&&r(n,s,{configurable:!0,get:function(){try{return o.call(this).match(d)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-dfd9a15a.0651765e.js.map